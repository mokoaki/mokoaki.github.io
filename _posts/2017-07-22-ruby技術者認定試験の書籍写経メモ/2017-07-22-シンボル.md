## シンボル Symbol

[Ruby技術者認定試験の書籍写経メモ]({% post_url 2017-07-22-ruby技術者認定試験の書籍写経メモ %})

- シンボルオブジェクトは
  - コロン「：」で始まる文字列で表します
  - 変更不可
  - 同じ表記であれば同じオブジェクトID（全く同じオブジェクトが使いまわされるという事

```ruby
:moko.object_id
=> 1158108

:moko.object_id
=> 1158108

:moko.equal?(:moko)
=> true
```

#### 何でみんなそんなにシンボルが好きなの？

- Ruby内部では変数名やメソッド名等は整数値で管理されている（速度面で有利になるらしい）が、この整数値をコード上で表したものがシンボル
- 文字列や整数値が重要な訳ではないが名前を付けたい、ような時にどんどん使っていきまっしょい

#### GC

2.2でシンボルもGCの対象になった。これまでは使われたシンボルは残っていた為、もし送信された文字列をシンボル化するシステムがあったとしたら、悪意を持つ人間が大量の文字列を送り込んだ場合にメモリの枯渇によりクラッシュの危険も・・みたいな怖い話だったらしい。

### 定義済みのSymbolオブジェクトを取得する

```ruby
Symbol.all_symbols.size
=> 3518

:moko
=> :moko

Symbol.all_symbols.size
=> 3519 # 増えた！

hage = 1
=> 1

Symbol.all_symbols.size
=> 3520 # 変数も内部ではシンボルで管理されているらしく・・増えた！
```
